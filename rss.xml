<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>Shaun Spinelli Blog</title>
        <link>https://shaunspinelli.github.io/</link>
        <description>Shaun Spinelli Blog</description>
        <lastBuildDate>Wed, 26 Jan 2022 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[How Track My Spotify Songs]]></title>
            <link>https://shaunspinelli.github.io/song tracking</link>
            <guid>https://shaunspinelli.github.io/song tracking</guid>
            <pubDate>Wed, 26 Jan 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Spotify Wrapped is cool, but I wanted to gain a more in-depth understanding of my music listening habits. Unfortunately, Spotify's API doesn't provide full access to your listening history. The next best option is to fetch the latest 50 tracks you've listened to. With this limitation in mind, I set out to create a project that could start recording all the songs I listened to and perform data analysis on them.]]></description>
            <content:encoded><![CDATA[<p>Spotify Wrapped is cool, but I wanted to gain a more in-depth understanding of my music listening habits. Unfortunately, Spotify's API doesn't provide full access to your listening history. The next best option is to fetch the latest 50 tracks you've listened to. With this limitation in mind, I set out to create a project that could start recording all the songs I listened to and perform data analysis on them.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="architecture">Architecture<a href="#architecture" class="hash-link" aria-label="Direct link to Architecture" title="Direct link to Architecture">​</a></h2><p>The basic architecture of the app consists of a serverless function that runs every 6 hours to fetch the latest songs you've listened to and stores them in a database. I can then query this database to perform various analyses. Additionally, I developed a web app that acts as an API, allowing users to register to have their own history tracked and proivide a full history of their songs.</p><p>To implement this I decided to leverage AWS services for fetching and storing the latest songs, while deploying the web app for registration and song viewing on Heroku.</p><p>Below is a high-level architecture diagram illustrating the components involved:</p><p><img loading="lazy" alt="Architecture Diagram" src="/assets/images/spotify-hist-arch-f2f395768a29208ecf77e96bc279612e.png" width="481" height="542" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="registrationviewing">Registration/Viewing<a href="#registrationviewing" class="hash-link" aria-label="Direct link to Registration/Viewing" title="Direct link to Registration/Viewing">​</a></h2><p>For registration and song viewing, I utilized <a href="https://github.com/spotipy-dev/spotipy" target="_blank" rel="noopener noreferrer">Spotify</a> for interfacing with Spotify's API and built the web app using Flask. The app is then deployed on Heroku, providing a seamless experience for users to register and access their tracked songs.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="saving-history">Saving History<a href="#saving-history" class="hash-link" aria-label="Direct link to Saving History" title="Direct link to Saving History">​</a></h2><p>To save the song history, I employed CloudWatch to trigger a function every 6 hours. This function fetches the users from the database and retrieves their latest songs, which are then added to DynamoDB for storage.</p><p><img loading="lazy" alt="Sequence Diagram" src="/assets/images/fetch-songs-seq-68f02cba2356027e9e4862b2bf3dc072.png" width="519" height="273" class="img_ev3q"></p><p>By tracking all the songs I listen to over the next year, I'll be able to create a more comprehensive Spotify Wrapped experience, delving deeper into my music preferences and habits.</p><p>Here is a <a href="https://github.com/ShaunSpinelli/spotify_history" target="_blank" rel="noopener noreferrer">LINK</a> to the repo and the specfic <a href="https://github.com/ShaunSpinelli/spotify_history/blob/master/lambdas/lambda_function.py" target="_blank" rel="noopener noreferrer">lambda</a> for fetcing the latest songs.</p>]]></content:encoded>
            <category>cloud</category>
            <category>webdev</category>
            <category>spotify</category>
        </item>
        <item>
            <title><![CDATA[IWild Cam 2019]]></title>
            <link>https://shaunspinelli.github.io/iwild cam 2019</link>
            <guid>https://shaunspinelli.github.io/iwild cam 2019</guid>
            <pubDate>Wed, 22 Jan 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[Competition Page]]></description>
            <content:encoded><![CDATA[<p><a href="https://www.kaggle.com/c/iwildcam-2019-fgvc6/overview" target="_blank" rel="noopener noreferrer">Competition Page</a></p><blockquote><p>"how do you classify a species in a new region that you may not have seen in previous training data?". </p></blockquote><p>In essence this challenge asks you to identify different species of animals from trail cam images.</p><p>I used fastai as it is an awesome library that allows for fast prototyping with built in best practices and feature like learning rate scheduling. Their data api also saves a lot of time in preprocessing data and creating train, validation and test sets. This allows you more time to focus on improving the performance of your solution. Also fastai V3 Part2 is coming out next month so I wanted to get comfortable with the library before tackling that course.</p><p><img loading="lazy" alt="trail_cam_images" src="/assets/images/trail_cam_images-31fb18ea3700dd08c6268dc1b9b09dd5.png" width="705" height="479" class="img_ev3q"></p><p>As you can see from the above images there is a range of challenges in this data set. Including small regions of interest (top left), images taken at night(top middle) and perspective (top right) to name just a few.</p><p>Another issue was the huge class imbalances present in the data set.  In the graph below you can see the class distributions. The empty class (which had 131,457 samples, over 67% of the training data) was removed. The mountain lion (22) had the fewest samples with only 33 training examples.</p><p><img loading="lazy" alt="samples" src="data:image/png;base64,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/3dy78D6x+nr61u2bNnAwEB/f7971VzJtWjRIj8/v7lz50ZGRpaWlg4ODrpR6oEHHlBVde3atSaTae3atcPDwyLS1NT0o4eG9uo7Vbz77rvr6ur27dt3/vz57OzsJ5988ssvv9yxY8f3LbV+/fo1a9acP38+JSVl3bp1NTU11dXVDz30kHsfbNPW1nbpHvzo0aNulCooKFi0aNHo6Oj27dvvvffe8PDwpqam7OxstxctLi7u0mPr6elxo9TBgwddnwL5yCOP/OUvf0lMTPzyyy9/+ctftra2ulFtYGBgcHAwJSUlKCgoJycnKyvrpz/9qdtPc+bMmUNDQ7Nmzfrggw/GXuFuh+CGDRvKysoGBwdvv/32Z5999p133mloaNiwYcP777//vd+Yv+aakpKSe++9t6SkJDAw0OFwXMlL4Kabbpo/f/7YXbvdvnTpUo1G8+9//9uNapmZmampqY2NjUFBQa6dgdFozMzMrK+v/76lTpw48de//lVEfvGLX2zfvj01NdVTzvevslPFuLi4sdsJCQmqqo6OjkZERLhRavHixa4boaGhY4O33nqrm1vua65JSUlZ8X+67rrr3Ktmd1JVdWBg4K233mpubr6SRQsICPjwww87x7FarcHBwW6UWrRo0YULF1RVTUpKGn8e6vZ5ouvGe++9V1RUFBgYuGLFildeecW9at9+++2Ekd7e3o8//ti9at/5z2Ns0G0HDhz4wx/+cCUV/vjHP6alpY09r7CwsCupdsstt1zm4OX82xgdHR27u2fPnqioqHnz5v3ooXG1heBtt932j3/8Q1VVs9k89kEM7vVsLE8fe+yxK389R0dHf/nllxMGdTqdJyxafn6+a9HGy8nJcaPUCy+8oNfrGxoannjiieLi4sbGxq1bt953331XGIIuDoejtrZ2/fr1nrBoycnJrhOOefPm/e1vf1NVtbGx0UM+EaCrqysjI6OkpOTMmTMLFiy4klJ6vX7Xrl0nT5503T158mR5efnKlSvdKPXII4+8884740dqa2sVRSEEJ9lHH32UmJg4Z86cn/3sZ8eOHVNV9euvv37++efdKLVly5azZ8+OH+no6Fi7dq17B/bWW2998cUXEwZdL56rzOHDhzMzMxcvXhwTE7Nq1apXXnnFtTd0Q1ZWlsc+zaNHj95xxx133nnn559/Xlxc7OPjExUVdeTIEc85QrPZnJSUFBgYeCVF+vv7H3300YiICF+nRYsWPfroo/39/e5V+/zzz999993xL6uamhpC8IcwKRc6J73UpFebDuvv4Yvmacc2NDT0ySefeEgLXnjhhVtuuSU9PX3+/PnV1dXfudknBKfK+HdtPKfUpFebDuvv4YvmscfmCS2IiYlx7QGtVmt8fPxzzz03Ke+iXrmr7erwJF7onMRSk15tOqy/hy+axx6bx7bg4sWLN9xwg4iEhYU1NjZmZGR89dVXnvDHGldbCPb09NTV1fn6+o7v2e233/7jlpr0atNh/T180Tz22Dy2BYGBgUePHl28eLGI3HDDDQcOHMjPz//kk08IwUl21113nTt3zrXQY1asWPHjlpr0atNh/T180Tz22Dy2BVVVVVrt/w4crVZbVVX161//+kdfMf52GMC0xqfIACAEAYAQBABCEAAIQQAgBAGAEAQAQhAACEEAIAQBgBAEgKvI/woAAP//dve5aACwIaEAAAAASUVORK5CYII=" width="428" height="273" class="img_ev3q"></p><p>My initial thought was I needed to train on large images if my model had any chance of detecting the smaller animals. So probably starting off with a smaller network like resnet34 the that would allow me to train on bigger crops sizes while still maintaining a reasonable batch size.</p><p>The first approach was to remove all the empty class images, train a model on only images containing animal then use the class probabilities and some threshold. eg: If the model didn't predict a class with a confidence of at least 0.4 the i would set the class to empty. This approach didn't work well with  a public LB score of 0.108. It was hard to find a threshold that worked well. Although I could have tried some other approaches to find a good threshold(run inference on the entire train set and test various how thresholds performed) I decided to try a second approach.</p><p>My second approach involved creating binary classifier, which would just predict if an animal was in an image. I then combined the results from these two models. If the animal detector model detects an animal I use the images class prediction as its final prediction other wise it will just be predicted as empty. This got me a public LB score of 0.156 and shot me up to 17th  place.</p><p>Looking at the class probabilities I could see that there was still opportunity for improvement.</p><p><img loading="lazy" alt="confidences" src="/assets/images/confidences-410f60a550adcb55e73da8e8180dee7c.png" width="699" height="207" class="img_ev3q"></p><p>Some predictions from the animal detector where right on the threshold, predicting no animal was in image with 0.5001 confidence while the animal classifier was predicting a elk with a 0.999 confidence(see above second last row). After finding a few more of these examples and checking the images I knew that there was potential to improve mmy results. I could try another threshold approach but thought a small Neural Net might be a fun solution.</p><p>I used a small two layer neural network. Although my training and validation results were good the results didn't carry through to the test set. So I knew the issue was probably in the accuracy of my classifier and animal detector.</p><p>Unfortunately I ran out of time to carry on working on this challenge but there are a couple of things i could have tried to improve accuracy.</p><p>1) Utilising saliency maps to crop out the regions of interest so the model as more of the animal in the image.</p><p>2) More data augmentation that replicates common features in the images eg: occlusion, darkness </p><blockquote><p>Note: There were bounding box annotations for the a subset of the training data but i choose not to use them</p></blockquote>]]></content:encoded>
            <category>kaggle</category>
        </item>
        <item>
            <title><![CDATA[UDA - Unsupervised Data Augmentation]]></title>
            <link>https://shaunspinelli.github.io/unsupervised data</link>
            <guid>https://shaunspinelli.github.io/unsupervised data</guid>
            <pubDate>Tue, 20 Aug 2019 00:00:00 GMT</pubDate>
            <description><![CDATA[I look into a paper that introduces a fresh perspective on the role of advanced data augmentation methods in semi-supervised learning, showcasing remarkable results across various language and vision tasks. I show the key findings and dive into code examples that highlight the power of these techniques]]></description>
            <content:encoded><![CDATA[<p>I look into a paper that introduces a fresh perspective on the role of advanced data augmentation methods in semi-supervised learning, showcasing remarkable results across various language and vision tasks. I show the key findings and dive into code examples that highlight the power of these techniques</p><p><a href="https://arxiv.org/abs/1904.12848" target="_blank" rel="noopener noreferrer">[Paper]</a> <a href="https://ai.googleblog.com/2019/07/advancing-semi-supervised-learning-with.html" target="_blank" rel="noopener noreferrer">[Blog Post]</a></p><p>All code snippets taken from this <a href="https://github.com/google-research/uda" target="_blank" rel="noopener noreferrer">repository</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-ideas-and-findings">Key Ideas and Findings<a href="#key-ideas-and-findings" class="hash-link" aria-label="Direct link to Key Ideas and Findings" title="Direct link to Key Ideas and Findings">​</a></h3><ul><li><p>Improving classification models with unlabeled data, data augmentation and semi-supervised learning. </p></li><li><p>Combining both labelled and unlabeled and using a custom loss function you can train a classifier for both computer vision and nlp problems.</p></li><li><p>Matches and outperforms supervised learning approaches with only a fraction of the data. </p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-results">Key Results<a href="#key-results" class="hash-link" aria-label="Direct link to Key Results" title="Direct link to Key Results">​</a></h3><p>1 - Using CIFAR-10 with 4k examples, UDA achieves an error rate of 5.27, matching the performance of a fully supervised model that uses 50k examples</p><p>2 - UDA achieves a new state-of-the-art error rate with a more than 45% reduction in error rate compared to the previous best semi-supervised result.</p><p>3 - On SVHN, UDA achieves an error rate of 2.46 with only 1k labeled examples, matching the performance of the fully supervised model trained with ~70k labeled examples.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="components">Components<a href="#components" class="hash-link" aria-label="Direct link to Components" title="Direct link to Components">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="loss-function">Loss Function<a href="#loss-function" class="hash-link" aria-label="Direct link to Loss Function" title="Direct link to Loss Function">​</a></h3><p>This loss function is calculated by combining two loss functions one for the supervised part of the data (labelled) and one for the unsupervised part of the data (UDA). There is also a weighting factor <strong>λ</strong> applied to the UDA loss function, researchers set <strong>λ</strong> to 1 for most of their experiments.</p><p><strong>Supervised Loss (Labelled Data)-</strong>  Cross entropy</p><p><strong>Unsupervised Consistency Loss (Unlabelled Data)-</strong> more specifically KL divergence, it is calculated between predicted distributions on the unlabeled examples and unlabeled augmented example.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-of-kl-divergence">Implementation of KL-divergence<a href="#implementation-of-kl-divergence" class="hash-link" aria-label="Direct link to Implementation of KL-divergence" title="Direct link to Implementation of KL-divergence">​</a></h3><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">uda/image/main.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># q_logits are the augmented logits </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_kl_divergence_with_logits</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p_logits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> q_logits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">softmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p_logits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_p </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log_softmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p_logits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_q </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log_softmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">q_logits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reduce_sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log_p </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> log_q</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> kl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="loss function" src="/assets/images/4-Figure1-1-bc83060a7524b291a4127fd3157f0543.png" width="986" height="400" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="augmentation-strategies">Augmentation Strategies<a href="#augmentation-strategies" class="hash-link" aria-label="Direct link to Augmentation Strategies" title="Direct link to Augmentation Strategies">​</a></h2><p>Image augmentation was done using  <strong>AutoAugment</strong> <a href="https://ai.googleblog.com/2018/06/improving-deep-learning-performance.html" target="_blank" rel="noopener noreferrer">[Paper]</a> <a href="https://towardsdatascience.com/how-to-improve-your-image-classifier-with-googles-autoaugment-77643f0be0c9" target="_blank" rel="noopener noreferrer">[Medium]</a> and <strong>Cutout</strong> <a href="https://arxiv.org/abs/1708.04552" target="_blank" rel="noopener noreferrer">[Paper]</a> was also used for experiments with CIFAR-10 and SVHN. It is noted that there is a trade off between having diverse augmented training examples and at the same time keeping the ground truth label matched. Many augmented samples where created for one ground truth and were all generated offline before training.</p><p>Text augmentation was done using back translation and a process called TF-IDF.</p><p><img loading="lazy" alt="UDA Data augmentation" src="/assets/images/UDA-augmentation-d194301c61c4f56a297127d37fe37abb.png" width="907" height="376" class="img_ev3q"></p><p><strong>Results from ablation study on different augmentation strategies</strong></p><p><img loading="lazy" alt="augmentation results" src="/assets/images/aug-results-f3a15f822c4d3adfff775d7dad6020ce.png" width="487" height="288" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="additional-training-techniques">Additional Training Techniques<a href="#additional-training-techniques" class="hash-link" aria-label="Direct link to Additional Training Techniques" title="Direct link to Additional Training Techniques">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="training-signal-annealing">Training Signal Annealing<a href="#training-signal-annealing" class="hash-link" aria-label="Direct link to Training Signal Annealing" title="Direct link to Training Signal Annealing">​</a></h3><p>By training on sch a small number of training samples there was a risk of the model overfitting to the labelled data. To negate that researches used (TSA) with the idea being to <em>gradually release training signals of the labeled data without overfitting as the model is trained on more and more unlabeled examples.</em></p><p>When the probability of the correct category is higher the some threshold then that example is removed from the loss calculation. This threshold prevents the model from over-training on examples it is already confident on.</p><p>Three threshold schedules were suggested with the decision on which to use dependant on the different ratios of labeled and unlabeled data.</p><p><strong>log-schedule</strong> where threshold is increased most rapidly at the beginning of training. Used when the model is <strong>less</strong> likely to overfit because of abundance of labeled examples or effective regularizations in the model.</p><p><strong>exp-schedule</strong> where threshold is increased most rapidly at the end of training. Used when the problem is <strong>more</strong> likely to overfit because of a relatively easy problem or the number of training examples is limited. The supervising signal get mostly released by the end of training.</p><p><strong>linear-schedule</strong> where the threshold is linearly increased while training.</p><p><img loading="lazy" alt="training signal schedules" src="/assets/images/5-Figure2-1-03f74b2cdc9f1037b5e679c30d5ae154.png" width="542" height="378" class="img_ev3q"></p><p><strong>Results from ablation study on different TSA schedules</strong></p><p><img loading="lazy" alt="training signal results" src="/assets/images/tsa-results-ee88fe7effa7e1d853626ff82ae1ed36.png" width="483" height="254" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-of-tsa">Implementation of TSA<a href="#implementation-of-tsa" class="hash-link" aria-label="Direct link to Implementation of TSA" title="Direct link to Implementation of TSA">​</a></h3><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">uda/image/main.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_tsa_threshold</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">schedule</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> global_step</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_train_steps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> start</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  step_ratio </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">global_step</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_train_steps</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> schedule </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"linear_schedule"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    coeff </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> step_ratio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> schedule </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"exp_schedule"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scale </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># [exp(-5), exp(0)] = [1e-2, 1]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    coeff </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">step_ratio </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> scale</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> schedule </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"log_schedule"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scale </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># [1 - exp(0), 1 - exp(-5)] = [0, 0.99]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    coeff </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">step_ratio</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> scale</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> coeff </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">end </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> start</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Usage </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># line 258</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> eff_train_prob_threshold </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_tsa_threshold</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      FLAGS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tsa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> global_step</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> FLAGS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">train_steps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tsa_start</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># line 276</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> larger_than_threshold </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">greater</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      correct_label_probs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> eff_train_prob_threshold</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sharpening-predictions">Sharpening Predictions<a href="#sharpening-predictions" class="hash-link" aria-label="Direct link to Sharpening Predictions" title="Direct link to Sharpening Predictions">​</a></h3><ul><li><strong>Confidence-based masking</strong> - If the predictions on the labelled data is below some confidence threshold then these predictions are removed from the final loss calculation, leaving only predictions with the highest confidence probabilities.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="implementation">Implementation<a href="#implementation" class="hash-link" aria-label="Direct link to Implementation" title="Direct link to Implementation">​</a></h3><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">uda/image/main.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ori_prob </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">softmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ori_logits</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">largest_prob </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reduce_max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ori_prob</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">loss_mask </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cast</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">greater</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">largest_prob</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> FLAGS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">uda_confidence_thresh</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">float32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># metric_dict["unsup/high_prob_ratio"] = tf.reduce_mean(loss_mask)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">loss_mask </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stop_gradient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">loss_mask</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aug_loss </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> aug_loss </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> loss_mask</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># metric_dict["unsup/high_prob_loss"] = tf.reduce_mean(aug_loss)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p><strong>Entropy minimization</strong></p></li><li><p><strong>Softmax temperature controlling</strong></p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="domain-relevance-data-filtering">Domain-relevance Data filtering<a href="#domain-relevance-data-filtering" class="hash-link" aria-label="Direct link to Domain-relevance Data filtering" title="Direct link to Domain-relevance Data filtering">​</a></h3><p>If the class distribution between the labeled and unlabeled data sets are unmatched it can hurt the performance of the model. To try and match the class distributions between the labeled and unlabeled data a model was trained on the labeled samples and used to infer the unlabeled samples class. Examples that the model was most confident on where then used for training.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="comparison-to-current-approaches">Comparison to current approaches<a href="#comparison-to-current-approaches" class="hash-link" aria-label="Direct link to Comparison to current approaches" title="Direct link to Comparison to current approaches">​</a></h3><p><img loading="lazy" alt="compare other apporaches" src="/assets/images/compare-results-50b86f6e7b80606b6bc6e0e41eab5f47.png" width="640" height="309" class="img_ev3q"></p>]]></content:encoded>
            <category>papers</category>
            <category>deeplearning</category>
        </item>
    </channel>
</rss>